<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper	namespace="com.yedam.finalPrj.facilityBusiness.serviceImpl.FacBusinessMapper">

<select id="findAll" resultType="com.yedam.finalPrj.facilityBusiness.service.FacReservation">
		select *
		from facility_reservation
</select>

<resultMap type="MemberVO" id="member">
	<result column="name" property="name"/>
	<result column="tel" property="tel"/>
</resultMap>
<resultMap type="com.yedam.finalPrj.facilityBusiness.service.FacReservation" id="facReservation">
	<result column="fac_res_no" property="facResNo"/>
	<result column="fac_no" property="facNo"/>
	<result column="pay_date" property="payDate"/>
	<result column="payment_amt" property="paymentAmt"/>
	<result column="status" property="status"/>
<collection property="member" resultMap="member"/>
</resultMap>

<select id="findAll2" resultMap="facReservation">
		select * 
		from facility_reservation r inner join member m
		on r.mem_no = m.mem_no
</select>
<select id="findDetail" parameterType="int" resultType="com.yedam.finalPrj.facilityBusiness.service.FacReservation">
		select *
		from facility_reservation
		where fac_res_no = #{resNo}
</select>
<select id="FindFacName" parameterType="int" resultType="String">
		select distinct  
		f.name
		from facility f	inner join facility_reservation r
		on f.fac_no = r.fac_no
		where r.fac_res_no = #{facResNo}
</select>
<select id="findNameTel"  parameterType="int" resultType="MemberVO">
		select m.name, m.tel
		from member m
		inner join facility_reservation r
		on m.mem_no = r.mem_no
		where fac_res_no = #{resNo}
</select>

<select id="findMyResList" parameterType="int" resultType="com.yedam.finalPrj.facilityBusiness.service.FacReservation">
		select * 
		from facility_reservation
		where mem_no = #{memNo}
</select>
<insert id="insert" parameterType="com.yedam.finalPrj.facility.service.Facility">
		insert into facility values(SEQ_FAC.NEXTVAL,#{name},default,#{thumbnail},#{price},#{startDate},#{endDate},#{startTime},#{endTime},#{tel},#{address},#{detail},'승인',1)
</insert>
<update id="update" parameterType="com.yedam.finalPrj.facility.service.Facility">
		update facility set name= #{name}, thumbnail = #{thumbnail}, price = #{price}, startDate = #{startDate}, endDate = #{endDate},
		startTime = #{startTime}, endTime = #{endTime}, tel = #{tel}, address = #{address}, detail = #{detail},'승인','1'
</update>
</mapper>
